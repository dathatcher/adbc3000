RECSIZE=80;BLOCKFACTOR=3;CODE=1052;EXTENTS=1;FILESIZE=103;ASCII;FORMAT=Fÿ001000$CONTROL DYNAMIC                                                          001100 IDENTIFICATION DIVISION.                                                 001200 PROGRAM-ID.   ADBCSECURITY.                                              001300 AUTHOR.       MGR-ADBC          .                                        001400                                                                          001500                                                                          001600 ENVIRONMENT DIVISION.                                                    001700 CONFIGURATION SECTION.                                                   001800 SOURCE-COMPUTER.   HP-3000.                                              001900 OBJECT-COMPUTER.   HP-3000.                                              002000 SPECIAL-NAMES.                                                           002100 CONDITION-CODE IS RETURN-CODE.                                           002200                                                                          002300$PAGE                                                                     002400 DATA DIVISION.                                                           002500 WORKING-STORAGE SECTION.                                                 002600                                                                          002700 01  VAR-NAME                    PIC X(19)  VALUE                         002800     "ADBC_INTRINSICS_OFF".                                               002900 01  VAR-STATUS                  PIC S9(9) COMP VALUE 0.                  003000 01  VAR-ITEM                    PIC 9(9) COMP VALUE 3.                   003100 01  VAR-ITEM-BACK               PIC S9(9) COMP VALUE 0.                  003200 01  VAR-NAME2.                                                           003300     05  VAR-FILLER              PIC X(5)  VALUE                          003400         "ADBC_".                                                         003500     05  VAR-PROC                PIC X(64)  VALUE " ".                    003600                                                                          003700 01  VAR-STATUS2                 PIC S9(9) COMP VALUE 0.                  003800 01  VAR-ITEM2                   PIC 9(9) COMP VALUE 3.                   003900 01  VAR-ITEM-BACK2              PIC S9(9) COMP VALUE 0.                  004000                                                                          004100                                                                          004200$PAGE                                                                     004300 LINKAGE SECTION.                                                         004400                                                                          004500*****                                                                     004600* USER IDENTIFICATION BUFFERS.                                            004700*****                                                                     004800                                                                          004900 01  SEC-STATUS                  PIC S9(9) COMP.                          005000 01  PROC-NAME                   PIC X(64).                               005100                                                                          005200$PAGE                                                                     005300                                                                          005400 PROCEDURE DIVISION USING SEC-STATUS,PROC-NAME.                           005500                                                                          005600**************************************                                    005700* MAIN PROGRAM FLOW                                                       005800**************************************                                    005900                                                                          006000 A000-MAIN-DRIVER-PARAGRAPH.                                              006100                                                                          006200      PERFORM B000-INITIALIZE THRU B999-EXIT.                             006300                                                                          006400      PERFORM C000-PROCESS-THINGS THRU C999-EXIT.                         006500                                                                          006600      GOBACK.                                                             006700                                                                          006800 A999-EXIT.                                                               006900     EXIT.                                                                007000                                                                          007100 B000-INITIALIZE.                                                         007200                                                                          007300     MOVE 0 TO SEC-STATUS.                                                007400                                                                          007500*    DISPLAY "PROC = ",PROC-NAME.                                         007600 B999-EXIT.                                                               007700     EXIT.                                                                007800                                                                          007900 C000-PROCESS-THINGS.                                                     008000                                                                          008100     CALL INTRINSIC "HPCIGETVAR" USING VAR-NAME,                          008200                                       VAR-STATUS,                        008300                                       VAR-ITEM,                          008400                                       VAR-ITEM-BACK.                     008500                                                                          008600*    DISPLAY "STATUS = ",VAR-ITEM-BACK.                                   008700     IF VAR-ITEM-BACK = 1                                                 008800         MOVE 1 TO SEC-STATUS                                             008900     ELSE                                                                 009000         MOVE 0 TO SEC-STATUS                                             009100         GO TO C999-EXIT.                                                 009200                                                                          009300     MOVE PROC-NAME(2:63)TO VAR-PROC.                                     009400*    DISPLAY "PROC:::",VAR-NAME2.                                         009500     CALL INTRINSIC "HPCIGETVAR" USING VAR-NAME2,                         009600                                       VAR-STATUS2,                       009700                                       VAR-ITEM2,                         009800                                       VAR-ITEM-BACK2.                    009900                                                                          010000*    DISPLAY "STATUS = ",VAR-ITEM-BACK2.                                  010100     IF VAR-ITEM-BACK2 = 1                                                010200         MOVE 0 TO SEC-STATUS                                             010300*     DISPLAY "=1"                                                        010400     ELSE                                                                 010500*      DISPLAY "=0"                                                       010600         MOVE -1 TO SEC-STATUS                                            010700      DISPLAY "WARNING:  An attempt was made to run ",VAR-PROC            010800         GO TO C999-EXIT.                                                 010900 C999-EXIT.                                                               011000    EXIT.                                                                 011100                                                                          011200                                                                          